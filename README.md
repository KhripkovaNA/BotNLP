## Система текстового поиска с использованием TF-IDF

Этот проект предоставляет сервисы для обработки текстов, создания индексов для поиска и выполнения текстового поиска с использованием подхода TF-IDF. Он состоит из веб-приложения, реализованного с использованием **FastAPI**, и клиентских скриптов для взаимодействия с REST API. Основная цель — предоставить быстрый и эффективный поиск релевантных текстов на основе запросов пользователя.

---

### Основная функциональность

1. **Предобработка текста**

   Пайплайн для удаления стоп-слов, лемматизации и очистке текста для дальнейшей обработки
   **Эндпоинт:** `/api/preprocess`

2. **Создание TF-IDF индекса**

   Генерация матрицы TF-IDF из обработанных текстов и сохранение модели для последующего использования

3. **Поиск релевантных текстов**

   Поиск текста, наиболее близкого к запросу пользователя, с использованием созданного индекса
   **Эндпоинт:** `/api/search`

4. **Клиентский скрипт**

   Скрипт для отправки запросов к REST API и получения результатов в удобной форме

---

### Структура проекта

```
BotNLP/
├── app/
│   ├── main.py                       # Основной файл FastAPI приложения, инициализация и запуск сервера
│   ├── text_processing/          
│   │   ├── router.py                 # Эндпоинт для обработки текста: принимает запросы, обрабатывает текст
│   │   ├── schemas.py                # Схемы запросов и ответов для эндпоинта
│   │   └── service.py                # Логика обработки текста: включает предобработку, очистку, лемматизацию и удаление стоп-слов
│   └── text_search/              
│       ├── create_tfidf.py           # Скрипт для создания и сохранения модели TF-IDF и соответствующей матрицы
│       ├── router.py                 # Эндпоинт для поиска текстов по запросу с использованием модели TF-IDF
│       └── service.py                # Логика поиска текстов, включает работу с сохраненной моделью и матрицей TF-IDF
├── data/                             # Папка для хранения текстов для поиска, формат файлов JSON
├── api_scripts/                      # Клиентские скрипты для отправки запросов к API
│   ├── text_processing_script.py
│   └── text_search_script.py
├── tests/                            # Папка для юнит-тестов: включает тесты для функциональности поиска и обработки текста
├── requirements.txt                  # Файл с зависимостями проекта, необходимые библиотеки для работы
├── .gitgnore
└── README.md                         # Документация по проекту
```

---

### Инструкция по установке и запуску

1. **Клонирование репозитория**  
   ```bash
   git clone https://github.com/KhripkovaNA/BotNLP.git
   cd BotNLP
   ```

2. **Установка зависимостей**

   Создайте и активируйте виртуальное окружение:  
   ```bash
   python -m venv venv
   source venv/bin/activate   # для Linux/MacOS
   venv\Scripts\activate      # для Windows
   pip install -r requirements.txt
   ```
   
3. **Запуск скрипта для создания и сохранения модели TF-IDF и соответствующей матрицы**

   Выполните скрипт для создания модели TF-IDF, матрицы и сопутствующих файлов:
   ```bash
   python -m app.text_search.create_tfidf
   ```
   После выполнения в корневой папке проекта появится директория `tfidf`, содержащая файлы:  
   - `tfidf_model.pkl` – сериализованная модель TF-IDF,  
   - `tfidf_matrix.pkl` – матрица,  
   - `texts.pkl` – тексты для поиска.

4. **Запуск сервера**

   ```bash
   uvicorn app.main:app
   ```
   Сервер запустится локально по адресу: [http://127.0.0.1:8000](http://127.0.0.1:8000).  
   Документация к API доступна по адресу: [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs).

### Тестирование и использование API

- **Запуск тестов**

   Для проверки работоспособности проекта выполните:
   ```bash
   python -m unittest discover -s tests -p "*.py"
   ```
  
- **Использование клиентских скриптов**

   Убедитесь, что сервер работает, затем выполните следующие шаги:
  - Перейдите в папку `api_scripts`:  
    ```bash
    cd api_scripts
    ```
  - Запустите клиентские скрипты:  
    - **Для предобработки текста:**  
      ```bash
      python text_processing_script.py
      ```
    - **Для поиска текста:**  
      ```bash
      python text_search_script.py
      ```

---

### **Замечания и возможные проблемы**

1. **Отсутствие необходимых файлов:**

   Убедитесь, что папка `tfidf` с файлами модели, матрицы и текстов создана перед запуском API. Если их нет, повторно выполните шаг 3.

2. **Ошибка "No module named app":**

   - Используйте запуск с флагом `-m`, чтобы избежать ошибок импорта модулей.  
   - Убедитесь, что вы запускаете команды из корневой папки проекта (`BotNLP`).

3. **Убедитесь в корректности данных:**

   Если клиентские скрипты не работают, проверьте, что сервер запущен, и папка `tfidf` содержит корректные данные.  

---

### Недостатки проекта

1. **Ограниченность алгоритма TF-IDF**

   Подход TF-IDF может не всегда учитывать семантическую близость текстов. Это может быть улучшено с использованием современных моделей NLP, таких как **BERT**.

2. **Чувствительность к качеству данных**

   Точность поиска зависит от качества предобработанных данных. Если тексты плохо очищены, результаты могут быть неточными.

3. **Ограниченная масштабируемость**

   При увеличении объема данных скорость поиска может снизиться, так как текущая реализация использует матрицу TF-IDF в оперативной памяти. 

4. **Отсутствие механизмов обновления индекса**

   В текущей версии добавление новых текстов требует пересоздания индекса с нуля.

---

### **Возможные улучшения**

1. Внедрение более продвинутых моделей для поиска, таких как **Word2Vec**, **Doc2Vec**, или **Sentence Transformers**.
2. Добавление функции обновления индекса без полного пересоздания.
3. Оптимизация поиска с использованием специальных библиотек, таких как **FAISS**.
